{% extends "base.html" %}
{% block content %}
<h2>è¨‚é¤æªåœ˜</h2>

{% if not group %}
  <div class="cta-wrap" style="margin:12px 0;">
    <a class="cta" href="{{ url_for('group_new', scope='order', next_page='order') }}">â• æ–°å¢ç¾¤çµ„</a>
    <a class="cta secondary" href="{{ url_for('group_join', scope='order', next_page='order') }}">ğŸ”‘ è¼¸å…¥ç¾¤çµ„é‚€è«‹ä»£ç¢¼</a>

  </div>
  <p class="muted">è«‹å…ˆå»ºç«‹æˆ–è¼¸å…¥ç¾¤çµ„ä»£ç¢¼ï¼Œæ‰èƒ½çœ‹åˆ°é¤å»³æ¸…å–®ã€‚</p>
{% else %}
  <p class="muted" style="margin:8px 0;">ç¾¤çµ„ä»£ç¢¼ï¼š<strong>{{ group.code }}</strong>{% if group.name %}ï¼ˆ{{ group.name }}ï¼‰{% endif %}</p>

  <div class="two-col">
    <div class="main">
      <p style="margin:8px 0;">
        <a href="{{ url_for('og_add_restaurant', code=group.code) }}">â• æ–°å¢é¤å»³</a>
        Â·
        <a href="{{ url_for('og_manage_restaurants', code=group.code) }}">ğŸ—‘ï¸ åˆªé™¤é¤å»³</a>
      </p>

      <div class="grid grid-4 restaurants-grid" style="margin-top:12px;">
        {% for r in restaurants %}
        <div class="card">
          <h3>{{ r.name }}</h3>
          <p>â˜ï¸ {{ r.phone or 'â€”' }}</p>
          <p>ğŸ•’ {{ r.hours or 'â€”' }}</p>
          {% if r.menu_url %}
            <p><a href="{{ r.menu_url }}" target="_blank" rel="noopener">ğŸ“‹ èœå–®</a></p>
          {% endif %}

          {% if r.id in fav_ids %}
            <form action="{{ url_for('toggle_favorite_order', code=group.code, order_restaurant_id=r.id) }}" method="post">
              <button type="submit" class="secondary">â˜… ç§»é™¤å¸¸è¨‚</button>
            </form>
          {% else %}
            <form action="{{ url_for('toggle_favorite_order', code=group.code, order_restaurant_id=r.id) }}" method="post">
              <button type="submit">â˜† åŠ å…¥å¸¸è¨‚</button>
            </form>
          {% endif %}
        </div>
        {% endfor %}
      </div>
    </div>

    <aside class="sidebar">
      {% include "partials/comment_panel.html" %}
    </aside>
  </div>
{% endif %}
{% endblock %}
